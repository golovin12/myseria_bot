# Телеграм бот, для получения новых серий с сайта MySerial
Перед запуском необходимо задать переменные окружения:
1) MY_SERIA_BOT_TOKEN - токен бота юзеров для сайта MySeria
2) ZETFLIX_BOT_TOKEN - токен бота юзеров для сайта Zetflix
3) ADMIN_BOT_TOKEN - токен бота админов

Необязательные параметры:

4) SECRET_TOKEN - Токен, для проверки того, что webhook установлен нами
5) SKIP_UPDATES - Нужно ли пропускать получить необработанные сообщения 
6) ADMIN_ID - id юзера, которому откроется доступ к админовскому боту.
7) VK_ACCESS_TOKEN - ключ доступа к VK API для динамического обновления адреса сайта с сериалами 
8) USE_NGROK - "True" для запуска бота в среде разработки. Для прода следует задать публичный url (config.HOST)

Запуск с помощью Docker:
> docker-compose up

Или запуск ботов и воркеров из локального окружения:
> python -m run
> 
> python -m management.run_dramatiq

* При первом запуске для работы ботов нужно задать адреса сайтов с сериалами для данных ботов. Актуальные адреса на 05.11.2023:
    * MySeria - https://serialrun.ru/
    * Zetflix - https://zetfix.online/
* Если задан VK_ACCESS_TOKEN, то адреса сайтов обновятся автоматически
* Иначе можно задать адреса сайтов введя команду в админовском боте #new_..._addr: https://...

## Пример работы бота:
![Alt text](/bot.png?raw=true "Пример использования бота")

### TODO:
* обрабатывать запросы к ботам в несколько процессов и потоков
* настроить отправку логов на почту и админам отправлять инфо о работе user-ботов
* тестирование для bots.handlers и serial_services.service
* парсинг озвучек из Zetflix
* разделить хранение сериалов юзера относительно сайтов
* добавить возможность задать вопрос админам
